function initialize(){directionsDisplay=new google.maps.DirectionsRenderer;var o={zoom:15,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map_canvas"),o),navigator.geolocation?navigator.geolocation.getCurrentPosition(function(o){function i(){a=map.getCenter()}pos=new google.maps.LatLng(o.coords.latitude,o.coords.longitude),currentPosLat=String(pos).replace(/\(|\)|\ /g,"").split(",")[0],currentPosLon=String(pos).replace(/\(|\)|\ /g,"").split(",")[1],$("#location").prop("value","near me"),myInfoWindowOptions={content:'<div class="info-window-content"><h4>Current Location</h4></div>',maxWidth:150},infoWindow=new google.maps.InfoWindow(myInfoWindowOptions);var n=new google.maps.MarkerImage("images/glow_dot.gif",new google.maps.Size(25,25),new google.maps.Point(0,0),new google.maps.Point(0,25)),e=new google.maps.Marker({draggable:!1,raiseOnDrag:!1,icon:n,map:map,position:pos,optimized:!1});google.maps.event.addListener(e,"click",function(){infoWindow.getMap()?infoWindow.close():infoWindow.open(map,e)}),google.maps.event.addListener(e,"dragstart",function(){infoWindow.close()}),infoWindow.open(map,e),setTimeout(function(){infoWindow.close()},2e3);var a;google.maps.event.addDomListener(map,"idle",function(){i()}),google.maps.event.addDomListener(window,"resize",function(){map.setCenter(a)}),map.setCenter(pos)},function(){handleNoGeolocation(!0)}):handleNoGeolocation(!1),showBookMarks()}function handleNoGeolocation(o){if(o)var i="Error: The Geolocation service failed.";else var i="Error: Your browser doesn't support geolocation.";var n={map:map,position:newyork,content:i};new google.maps.InfoWindow(n);map.setCenter(n.position)}function addColumbiaMarker(){var o=new google.maps.LatLng(40.8006,-73.9653),i=new google.maps.Marker({draggable:!1,raiseOnDrag:!1,icon:"http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png",map:map,animation:google.maps.Animation.DROP,position:o});i.setMap(map)}function addMoreResultMarker(o){addResultMarker(o,resultMarkers.length)}function addResultMarker(o,i){o.display_phone?phone=o.display_phone:phone="No phone  number available";var n;n=void 0!=o.image_url?o.image_url:"images/defaultBusiness.png";for(var e=new google.maps.LatLng(o.location.coordinate.latitude,o.location.coordinate.longitude),a="",t=0;t<o.location.display_address.length;t++)a+=o.location.display_address[t]+"<br />";var s=JSON.stringify(o).replace(/"/g,"&quot;");pos?resultInfoWindowOptions={content:'<div id="infoWindow'+i+'" class="info-window-content"><div id="iwImage"><img src="'+n+'"></div><div id="data"><div id="iwText"><h4 id="iwName">'+o.name+"</h4><h5>"+phone+"</h5><div>"+a+'</div><br /><img id="iwRating" src="'+o.rating_img_url+'" /></div><button id="iwBookButton" class="btn btn-small" style="" style="margin-top: 2px" title="Add Bookmark" onclick="addBookmarkBtnClick('+s+',$(this)); "><i class="icon-bookmark"></i></button></div><button id="iwBookButton" class="btn btn-small" style="" style="margin-top: 2px" title="Get Driving Directions" onclick="calcRoute('+o.location.coordinate.latitude+", "+o.location.coordinate.longitude+');"><i class="icon-road"></i></button></div></div>',maxWidth:400}:resultInfoWindowOptions={content:'<div id="infoWindow'+i+'" class="info-window-content"><div id="iwImage"><img src="'+n+'"></div><div id="data"><div id="iwText"><h4 id="iwName">'+o.name+"</h4><h5>"+phone+"</h5><div>"+a+'</div><br /><img id="iwRating" src="'+o.rating_img_url+'" /></div><button id="iwBookButton" class="btn btn-small" style="" style="margin-top: 2px" title="Add Bookmark" onclick="addBookmarkBtnClick('+s+',$(this));"><i class="icon-bookmark"></i></button></div></div></div>',maxWidth:400},info=new google.maps.InfoWindow(resultInfoWindowOptions),infoWindows.push(info);var r=new google.maps.Marker({draggable:!1,raiseOnDrag:!1,icon:"http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png",map:map,animation:google.maps.Animation.DROP,zIndexProcess:"9900",position:e});google.maps.event.addListener(r,"click",function(){clearInfoWindows(),clearBookWindows(),infoWindows[i].open(map,r)}),google.maps.event.addListener(r,"dragstart",function(){infoWindows[t].close()}),resultMarkers.push(r)}function addBookMarker(o,i){var n;o.display_phone?phone=o.display_phone:phone="No phone  number available",n=void 0!=o.image_url?o.image_url:"images/defaultBusiness.png";for(var e=new google.maps.LatLng(o.location.coordinate.latitude,o.location.coordinate.longitude),a="",t=0;t<o.location.display_address.length;t++)a+=o.location.display_address[t]+"<br />";JSON.stringify(o).replace(/"/g,"&quot;");if(pos)var s={content:'<div id="infoWindow'+i+'" class="info-window-content"><div id="iwImage"><img src="'+n+'"></div><div id="data"><div id="iwText"><h4 id="iwName">'+o.name+"</h4><h5>"+phone+"</h5><div>"+a+'</div><br /><img id="iwRating" src="'+o.rating_img_url+'" /></div></div><button id="iwBookButton" class="btn btn-small" style="" style="margin-top: 2px" title="Get Driving Directions" onclick="calcRoute('+o.location.coordinate.latitude+", "+o.location.coordinate.longitude+');"><i class="icon-road"></i></button></div></div>',maxWidth:400};else var s={content:'<div id="infoWindow'+i+'" class="info-window-content"><div id="iwImage"><img src="'+n+'"></div><div id="data"><div id="iwText"><h4 id="iwName">'+o.name+"</h4><h5>"+phone+"</h5><div>"+a+'</div><br /><img id="iwRating" src="'+o.rating_img_url+'" /></div></div></div></div>',maxWidth:400};info=new google.maps.InfoWindow(s),bookWindows.push(info);var r=new google.maps.Marker({draggable:!1,raiseOnDrag:!1,icon:"http://www.google.com/intl/en_us/mapfiles/ms/micons/red-dot.png",map:map,animation:google.maps.Animation.DROP,zIndexProcess:"9999",position:e});google.maps.event.addListener(r,"click",function(){clearInfoWindows(),clearBookWindows(),bookWindows[i].open(map,r)}),google.maps.event.addListener(r,"dragstart",function(){bookWindows[t].close()}),bookMarkers.push(r)}function clearSearchMarks(){if(resultMarkers.length>0)for(i in resultMarkers)resultMarkers[i].setMap(null)}function showSearchMarks(){var o=new google.maps.LatLngBounds;if(resultMarkers.length>0){for(i in resultMarkers)resultMarkers[i].setMap(map),o.extend(resultMarkers[i].position);map.panToBounds(o),map.fitBounds(o)}}function showBookMarks(){if(bookMarkers.length>0)for(i in bookMarkers)bookMarkers[i].setMap(map)}function boundBookMarks(){var o=new google.maps.LatLngBounds;if(bookMarkers.length>0){for(i in bookMarkers)bookMarkers[i].setMap(map),o.extend(bookMarkers[i].position);setTimeout(function(){map.panToBounds(o),map.fitBounds(o)},500)}}function clearBookMarks(){if(bookMarkers.length>0)for(i in bookMarkers)bookMarkers[i].setMap(null)}function deleteBookMarks(){if(bookMarkers.length>0){for(i in bookMarkers)bookMarkers[i].setMap(null);bookMarkers.length=0}}function deleteSearchMarks(){if(resultMarkers.length>0){for(i in resultMarkers)resultMarkers[i].setMap(null);resultMarkers.length=0}}function deleteInfoWindows(){if(infoWindows.length>0){for(i in infoWindows)infoWindows[i].close();infoWindows.length=0}}function deleteBookInfoWindows(){if(bookWindows.length>0){for(i in bookWindows)bookWindows[i].close();bookWindows.length=0}}function clearInfoWindows(){if(infoWindows.length>0)for(i in infoWindows)infoWindows[i].close()}function clearBookWindows(){if(bookWindows.length>0)for(i in bookWindows)bookWindows[i].close()}function calcRoute(o,i){$("#directions").empty();var n=new google.maps.LatLng(o,i);directionsService=new google.maps.DirectionsService;var e=pos,a={origin:e,destination:n,travelMode:google.maps.DirectionsTravelMode.DRIVING};directionsService.route(a,function(o,i){i==google.maps.DirectionsStatus.OK&&directionsDisplay.setDirections(o)}),directionsDisplay.setOptions({suppressMarkers:!0}),directionsDisplay.setPanel(document.getElementById("directions")),$("#directionsModal").modal("show")}var newyork=new google.maps.LatLng(40.69847032728747,-73.9514422416687),map,pos,currentPosLat,currentPosLon,resultMarkers=[],infoWindows=[],bookMarkers=[],bookWindows=[],addBookmarkLocation={},directionsDisplay,directionsService=new google.maps.DirectionsService;google.maps.event.addDomListener(window,"load",initialize);