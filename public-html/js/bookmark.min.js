if(!bookmark)var bookmark={};bookmark.user="Jim",bookmark.maxTagCnt=20,bookmark.userChange=function(t){this.user=$(t).val(),$("#searchResultPanel").empty(),$("#categorySelect").empty(),$("#categorySelect").append("<h2>Search</h2>"),updateBookmarks()},bookmark.getItem=function(t,e){e="undefined"!=typeof e?e:"object";var a=JSON.parse(localStorage.getItem(this.user));return"JSON"==e?a?JSON.stringify(a[t]):null:"object"==e&&(a?a[t]:null)},bookmark.addNewTag=function(t){for(var e=this.getItem("tags","object"),a=0;a<t.length;a++){if(e.length>=this.maxTagCnt){alert("Tag Overflow");break}e.indexOf(t[a])==-1&&e.push(t[a])}return e},bookmark.add=function(t,e,a){var o;"object"==typeof t?o=JSON.stringify(t):"string"==typeof t&&(o=t);for(var r=this.getItem("bookmarks","object"),s=e.split("|"),i=s.slice(1,s.length);i.indexOf("")!=-1;)i.pop();if(r){var n=this.getItem("pushCnt","JSON"),k=parseInt(n)+1;r.push({id:k,obj:o,tags:i,comment:a});var l=(this.getItem("tags","object"),{pushCnt:k,tags:this.addNewTag(i),bookmarks:r});localStorage.setItem(this.user,JSON.stringify(l))}else{var l={pushCnt:1,tags:i,bookmarks:new Array({id:1,obj:o,tags:i,comment:a})};localStorage.setItem(this.user,JSON.stringify(l))}},bookmark.deleteItem=function(t){for(var e,a,o=this.getItem("bookmarks","object"),r=0;r<o.length;r++)if(o[r].id==t){e=o[r].tags,a=JSON.parse(o[r].obj).categories,o.splice(r,1);break}if(null!=e)for(var s=[],i=[],r=0;r<o.length;r++)if(o[r].id!=t){for(var n=o[r].tags,k=JSON.parse(o[r].obj).categories,l=0;l<e.length;l++)n.indexOf(e[l])>-1&&s.push(e[l]);for(var l=0;l<k.length;l++)k.indexOf(a[l])>-1&&i.push(a[l])}e=e.filter(function(t){return s.indexOf(t)==-1});for(var g=this.getItem("tags"),r=0;r<e.length;r++)g.splice(g.indexOf(e[r]),1);a=a.filter(function(t){return i.indexOf(t)==-1});for(var r=0;r<a.length;r++)cats.splice(cats.indexOf(a[r]),1),totalCats.splice(totalCats.indexOf(a[r]),1);var f={pushCnt:this.getItem("pushCnt"),tags:g,bookmarks:o};localStorage.setItem(this.user,JSON.stringify(f)),updateBookmarks()},bookmark.clear=function(){localStorage.clear()},bookmark.alreadyBookmark=function(t){var e=t.id,a=this.getItem("bookmarks","object");if(a)for(var o=0;o<a.length;o++)if(JSON.parse(a[o].obj).id==e)return!0;return!1},bookmark.updateAddBookmarkBtn=function(t){$('#searchResultPanel .eachResult input[value="'+t+'"]').each(function(){$(".addBookmark",$(this).parent()).removeClass("disabled").removeAttr("disabled")})},bookmark.getBookmarkById=function(t){for(var e,a=this.getItem("bookmarks","object"),o=0;o<a.length;o++)if(a[o].id==t){e=a[o];break}return e},bookmark.updateTagColor=function(t){t.categories};